:root{
  --pin-brand:#2E5F73;
  --pin-brand-700:#0e3a4c;
  --pin-ink:#0f172a;
  --pin-muted:#64748b;
  --pin-border:rgba(15,23,42,.10);
  --pin-bg:#f6f8fb;
}

.pinX{
  background:
    radial-gradient(1200px 500px at 10% -10%, rgba(46,95,115,.16), transparent 60%),
    radial-gradient(900px 500px at 95% 0%, rgba(14,58,76,.12), transparent 55%),
    var(--pin-bg);
  min-height:100vh;
  padding:12px 10px 22px;
}

/* topbar */
.pinX__topbar{max-width:1120px;margin:0 auto 10px;display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px}
.pinX__back{
  display:inline-flex;align-items:center;gap:10px;border:1px solid var(--pin-border);background:#fff;color:var(--pin-brand-700);
  border-radius:12px;padding:9px 12px;font-weight:800;font-size:13px;cursor:pointer;
  box-shadow:0 8px 22px rgba(15,23,42,.06);transition:.12s ease;
}
.pinX__back:hover{transform:translateY(-1px)}
.pinX__back i{color:var(--pin-brand)}
.pinX__topRight{display:flex;align-items:center;gap:10px}
.pinX__pill{
  display:inline-flex;align-items:center;gap:8px;font-size:12px;font-weight:900;color:var(--pin-brand-700);
  background:rgba(46,95,115,.10);border:1px solid rgba(46,95,115,.22);padding:7px 10px;border-radius:999px;white-space:nowrap;
}
.pinX__pill i{color:var(--pin-brand)}

.pinX__wrap{max-width:1120px;margin:0 auto}
.pinX__card{background:#fff;border:1px solid var(--pin-border);border-radius:18px;box-shadow:0 18px 55px rgba(15,23,42,.10);overflow:hidden}

/* head */
.pinX__head{
  display:grid;grid-template-columns:1fr auto;gap:12px;padding:16px 16px 12px;border-bottom:1px solid var(--pin-border);
  background:linear-gradient(180deg, rgba(46,95,115,.08), rgba(46,95,115,.03));
}
.pinX__title{margin:0;color:var(--pin-brand);font-weight:900;font-size:18px}
.pinX__sub{margin-top:3px;font-size:12px;color:var(--pin-muted);font-weight:700}
.pinX__summary{display:flex;gap:10px;align-items:stretch}
.pinX__sumItem{background:#fff;border:1px solid var(--pin-border);border-radius:14px;padding:10px 12px;min-width:140px}
.pinX__sumItem .k{font-size:11px;color:var(--pin-muted);font-weight:900}
.pinX__sumItem .v{margin-top:2px;font-size:14px;font-weight:900;color:var(--pin-ink)}
.pinX__sumItem--strong{border-color:rgba(46,95,115,.25);background:rgba(46,95,115,.06)}
.pinX__sumItem--strong .v{color:var(--pin-brand-700)}

/* section */
.pinX__section{padding:12px 16px}
.pinX__sectionHead{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.pinX__sectionTitle{display:inline-flex;align-items:center;gap:8px;font-weight:900;color:var(--pin-brand-700);font-size:13px}
.pinX__scrollHint{display:inline-flex;align-items:center;gap:8px;color:#64748b;font-weight:900;font-size:12px}

/* grid */
.pinX__grid{display:grid;grid-template-columns:repeat(12,1fr);gap:10px}
.pinX__field{grid-column:span 12}
@media(min-width:900px){ .pinX__field{grid-column:span 3} }

.grn-combobox{position:relative}

/* inputs */
.pinX__label{display:block;font-size:11px;font-weight:900;color:#475569;margin-bottom:6px}
.pinX__input{
  width:100%;height:36px;border:1px solid #d8d6de;border-radius:12px;padding:0 12px;font-size:13px;outline:none;background:#fff;
  transition:box-shadow .12s ease,border-color .12s ease;
}
.pinX__input:focus{border-color:var(--pin-brand);box-shadow:0 0 0 4px rgba(46,95,115,.18)}
.pinX__input--readonly{background:#f8fafc;color:#334155}

.pinX__combo{position:relative}
.pinX__input--withCaret{padding-right:44px}

/* caret */
.pinX__caretBtn{
  position:absolute;right:8px;top:50%;transform:translateY(-50%);
  width:28px;height:28px;border:0;border-radius:10px;background:transparent;color:#64748b;
  display:grid;place-items:center;cursor:pointer;
}
.pinX__caretBtn:hover{background:rgba(46,95,115,.08);color:var(--pin-brand-700)}
.pinX__caretBtn i{font-size:12px}

/* dropdown */
.pinX__dropdown{
  position:absolute;left:0;top:calc(100% + 6px);
  width:100%;max-width:420px;z-index:60;background:#fff;border:1px solid var(--pin-border);
  border-radius:14px;box-shadow:0 16px 45px rgba(15,23,42,.16);overflow:hidden;
  max-height:220px;overflow:auto;
}
.pinX__dropHead{
  padding:10px 12px;font-size:12px;font-weight:900;color:var(--pin-brand-700);
  background:rgba(46,95,115,.06);border-bottom:1px solid var(--pin-border);
}
.pinX__dropItemOneLine{
  width:100%;display:flex;align-items:center;gap:8px;padding:10px 12px;border:0;background:#fff;cursor:pointer;text-align:left;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
.pinX__dropItemOneLine:hover{background:#f1f5f9}
.pinX__dropItemOneLine .xNo{font-weight:900;color:#0f172a}
.pinX__dropItemOneLine .xSup{font-weight:800;color:#475569;overflow:hidden;text-overflow:ellipsis}
.pinX__dropItemOneLine .xPo{font-weight:900;color:#64748b}
.pinX__dropItemOneLine .xSep{color:#94a3b8;font-weight:900}
.pinX__dropEmpty{padding:12px;color:#94a3b8;font-weight:800;font-size:12px}

/* tax */
.pinX__taxRow{display:grid;grid-template-columns:1.2fr 1fr;gap:8px;align-items:center}
.pinX__select{appearance:none;background:#fff}
.pinX__taxPct{position:relative}
.pinX__suffix{position:absolute;right:10px;top:50%;transform:translateY(-50%);font-size:12px;font-weight:900;color:#94a3b8}
.pinX__hint{margin-top:6px;font-size:11px;color:var(--pin-muted);font-weight:700}

/* =========================
   ✅ LINES TABLE (FINAL FIX)
   ========================= */

/* ✅ scroll container */
.pinX__tableScroll{
  width:100%;
  overflow-x:auto;
  overflow-y:hidden;
  -webkit-overflow-scrolling:touch;
  padding-bottom:8px;
}

/* ✅ a shell to position fade OUTSIDE without covering inputs */
.pinX__tableShell{
  position:relative;
  display:inline-block;   /* important: size fits content */
  min-width:100%;
}

/* ✅ table wrap must NOT clip columns */
.pinX__tableWrap{
  border:1px solid var(--pin-border);
  border-radius:16px;
  background:#fff;

  /* ✅ DO NOT hide - otherwise right side (discount/total) gets cut */
  overflow:visible;

  /* ✅ guarantee enough width for all columns */
  min-width: 1180px;
}

/* header */
.pinX__tableHead{
  background:var(--pin-brand-700);
  color:#fff;
  font-weight:900;
  font-size:12px;
  border-radius:16px 16px 0 0;
  overflow:hidden; /* only header corners */
}
.pinX__tableHead > div{padding:10px}

/* rows */
.pinX__tr{
  border-top:1px solid rgba(15,23,42,.08);
  background:#fff;
}
.pinX__tr:nth-child(even){background:#fbfdff}
.pinX__tr > div{padding:10px}

/* ✅ column grid */
.pinX__rowFixed{
  display:grid;
  grid-template-columns:
    200px              /* Item */
    420px              /* Ledger */
    220px              /* Location */
    110px              /* Qty */
    150px              /* Unit price */
    150px              /* Discount */
    170px;             /* Total */
  align-items:center;
  column-gap:12px;
}

/* prevent column overflow pushing */
.c2{min-width:0}
.pinX__cellInput{width:100%;min-width:0}
.tR{text-align:right}
.pinX__lineTotal{font-weight:900;color:var(--pin-ink);white-space:nowrap}

/* ✅ RIGHT fade - but placed ABOVE only at edge, not covering columns */
.pinX__scrollFadeRight{
  position:absolute;
  top:0;
  right:0;
  width:34px;
  height:100%;
  pointer-events:none;
  z-index:2;
  background:linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,1));
  border-radius:0 16px 16px 0;
}

/* empty */
.pinX__empty{padding:14px;text-align:center;color:#94a3b8;font-weight:800;font-size:12.5px}

/* responsive shrink (still keep all columns) */
@media (max-width: 1200px){
  .pinX__tableWrap{ min-width: 1080px; }
  .pinX__rowFixed{
    grid-template-columns:
      180px
      360px
      200px
      100px
      140px
      140px
      160px;
  }
}

/* totals below */
.pinX__totalsBelow{margin-top:12px;display:flex;justify-content:flex-end}
.pinX__totalsCard{
  width:min(520px, 100%);
  border:1px solid var(--pin-border);
  border-radius:16px;
  background:#fff;
  box-shadow:0 10px 26px rgba(15,23,42,.06);
  overflow:hidden;
}
.pinX__totalsTitle{
  padding:12px;
  font-weight:900;
  color:var(--pin-brand-700);
  background:rgba(46,95,115,.06);
  border-bottom:1px solid var(--pin-border);
  display:flex;align-items:center;gap:8px;
}
.pinX__totalsRows{padding:12px;display:grid;gap:10px}
.pinX__totalsRows .r{display:flex;align-items:center;justify-content:space-between;gap:12px;font-weight:800;color:#334155}
.pinX__totalsRows .k{font-size:12px}
.pinX__totalsRows .v{font-size:13px;font-weight:900;color:var(--pin-ink)}
.pinX__totalsRows .muted{color:#94a3b8;font-weight:900;margin-left:6px;font-size:11px}
.pinX__totalsRows .sep{height:0;border-top:1px dashed rgba(15,23,42,.18);margin:2px 0}
.pinX__totalsRows .strong .v{font-size:14px}
.pinX__totalsRows .brand .v{color:var(--pin-brand-700)}

/* actions */
.pinX__actions{
  display:flex;justify-content:flex-end;gap:10px;padding:12px 16px 16px;border-top:1px solid var(--pin-border);
  background:linear-gradient(180deg, rgba(255,255,255,.65), #fff);
}
.pinX__btn{
  height:38px;border-radius:12px;padding:0 14px;font-weight:900;font-size:13px;border:1px solid var(--pin-border);
  background:#fff;color:#334155;display:inline-flex;align-items:center;gap:8px;cursor:pointer;transition:.12s ease;
}
.pinX__btn:hover{transform:translateY(-1px)}
.pinX__btn:disabled{opacity:.6;cursor:not-allowed;transform:none}
.pinX__btn--brand{background:var(--pin-brand);border-color:var(--pin-brand);color:#fff;box-shadow:0 10px 26px rgba(46,95,115,.25)}
.pinX__btn--brand:hover{background:#284e5e;border-color:#284e5e}
.pinX__btn--primary{background:var(--pin-brand-700);border-color:var(--pin-brand-700);color:#fff;box-shadow:0 10px 26px rgba(14,58,76,.22)}
.pinX__btn--primary:hover{background:#0b2f3d;border-color:#0b2f3d}

/* ng-select */
:host ::ng-deep .pinX__ngSelect--fixed.ng-select.ng-select-single .ng-select-container{
  height:36px !important;
  min-height:36px !important;
  border-radius:12px !important;
  border:1px solid #d8d6de !important;
  display:flex !important;
  align-items:center !important;
  box-shadow:none !important;
  overflow:hidden !important;
}
:host ::ng-deep .pinX__ngSelect--fixed .ng-value-container{
  padding:0 10px !important;
  display:flex !important;
  align-items:center !important;
  min-width:0 !important;
}
:host ::ng-deep .pinX__ngSelect--fixed .ng-input{
  top:50% !important;
  transform:translateY(-50%) !important;
}
:host ::ng-deep .pinX__ngSelect--fixed .ng-arrow-wrapper{
  width:30px !important;
  display:flex !important;
  align-items:center !important;
  justify-content:center !important;
}
.pinX__ngLabel{
  display:block;
  max-width:100%;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  font-weight:700;
}
.pinX__ngOption{
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}